<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡∏™</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap" rel="stylesheet" />
<style>
  /* Reset & base */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: 'Prompt', sans-serif;
    background: linear-gradient(135deg, #a8d0ff, #374785);
    color: #1b2a49;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  a {
    text-decoration: none;
    cursor: pointer;
  }

  /* Nav */
  nav {
    background: #243b55;
    padding: 1rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 10px rgba(0,0,0,0.15);
    position: sticky;
    top: 0;
    z-index: 10;
  }
  nav h2 {
    color: #f0f4f8;
    font-weight: 600;
    font-size: 1.5rem;
    letter-spacing: 1.2px;
  }
  nav div {
  display: flex;
  gap: 1.8rem;
}

.nav-btn {
  background: linear-gradient(135deg, #4472ff, #7aaeff);
  border: none;
  color: white;
  font-weight: 600;
  font-size: 1.1rem;
  padding: 8px 20px;
  border-radius: 40px;
  cursor: pointer;
  box-shadow: 0 5px 15px rgba(122, 174, 255, 0.6);
  transition: background 0.3s ease, box-shadow 0.3s ease, transform 0.2s ease;
}

.nav-btn:hover {
  background: linear-gradient(135deg, #2a53e0, #5c8edb);
  box-shadow: 0 8px 20px rgba(42, 83, 224, 0.8);
  transform: translateY(-2px);
}

.nav-btn:active {
  transform: translateY(1px);
}


  /* Back button */
  #back-btn {
    display: none;
    padding: 1rem 2rem;
    background: #e8f0ff;
    box-shadow: 0 4px 10px rgba(122, 174, 255, 0.3);
    margin: 1rem auto;
    max-width: 800px;
    border-radius: 30px;
    text-align: left;
  }
  #back-btn button {
    font-size: 1rem;
    font-weight: 600;
    color: #374785;
    background: #7aaeff;
    border: none;
    padding: 10px 28px;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 5px 15px rgba(122, 174, 255, 0.7);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }
  #back-btn button:hover {
    background-color: #5c8edb;
    box-shadow: 0 8px 20px rgba(92, 142, 219, 0.8);
  }

  /* Pages styling */
  #intro-page, #game-page, #wish-page {
    max-width: 800px;
    margin: 2rem auto 4rem;
    background: rgba(255 255 255 / 0.9);
    border-radius: 24px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    padding: 3rem 2.5rem;
    text-align: center;
    animation: fadeIn 0.7s ease forwards;
  }
  #game-page, #wish-page {
    display: none;
  }

  /* Header text */
  header h1 {
    font-size: 2.6rem;
    margin-bottom: 1rem;
    font-weight: 700;
    color: #243b55;
  }
  header p {
    font-size: 1.3rem;
    line-height: 1.7;
    color: #3d4e6f;
  }

  /* Buttons */
  .start-btn {
    margin-top: 3rem;
    background: linear-gradient(135deg, #4472ff, #7aaeff);
    border: none;
    color: white;
    font-weight: 700;
    font-size: 1.25rem;
    padding: 16px 48px;
    border-radius: 40px;
    cursor: pointer;
    box-shadow: 0 8px 20px rgba(122, 174, 255, 0.6);
    transition: background 0.3s ease, box-shadow 0.3s ease, transform 0.2s ease;
  }
  .start-btn:hover {
    background: linear-gradient(135deg, #2a53e0, #5c8edb);
    box-shadow: 0 12px 25px rgba(92, 142, 219, 0.9);
    transform: translateY(-3px);
  }
  .start-btn:active {
    transform: translateY(1px);
  }

  /* Puzzle board */
  #puzzle-board {
    margin: 2rem auto 3rem;
    width: 350px;
    height: 460px;
    border-radius: 20px;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    gap: 2px;
    background: #f0f4ff;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.07);
    border: 5px solid #7aaeff;
  }
  .piece {
    border-radius: 14px;
    cursor: grab;
    box-shadow: 0 3px 12px rgba(0, 0, 0, 0.15);
    background-size: 300% 300%;
    transition: box-shadow 0.3s ease;
  }
  .piece:active {
    cursor: grabbing;
    box-shadow: 0 8px 18px rgba(0, 0, 0, 0.25);
  }

  /* Shuffle button */
  .center-btn {
    display: flex;
    justify-content: center;
    margin-bottom: 2rem;
  }
  #shuffleBtn {
    font-size: 1.2rem;
    padding: 12px 36px;
    border-radius: 35px;
    border: none;
    background: #f3f7ff;
    color: #4472ff;
    font-weight: 600;
    box-shadow: 0 6px 15px rgba(68, 114, 255, 0.3);
    cursor: pointer;
    transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
  }
  #shuffleBtn:hover {
    background-color: #4472ff;
    color: white;
    box-shadow: 0 10px 25px rgba(68, 114, 255, 0.7);
    transform: translateY(-2px);
  }
  #shuffleBtn:active {
    transform: translateY(1px);
  }

  /* Popup overlays */
  .popup {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(36, 59, 85, 0.8);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    animation: fadeIn 0.3s ease forwards;
  }
  .popup-content {
    background: white;
    padding: 30px 40px;
    border-radius: 24px;
    max-width: 90%;
    width: 400px;
    box-shadow: 0 10px 35px rgba(36, 59, 85, 0.2);
    text-align: center;
    font-size: 1.1rem;
    color: #243b55;
    position: relative;
  }
  .popup-content h2 {
    margin-top: 0;
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 1rem;
  }
  .popup-content p {
    line-height: 1.6;
    margin-bottom: 2rem;
  }
  .popup-content button {
    background: #4472ff;
    border: none;
    color: white;
    font-weight: 700;
    padding: 12px 40px;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 8px 20px rgba(68, 114, 255, 0.6);
    transition: background-color 0.3s ease, box-shadow 0.3s ease, transform 0.2s ease;
  }
  .popup-content button:hover {
    background-color: #2a53e0;
    box-shadow: 0 12px 28px rgba(42, 83, 224, 0.9);
    transform: translateY(-3px);
  }
  .popup-content button:active {
    transform: translateY(1px);
  }

  /* Wish page image */
  #wish-page img {
    max-width: 280px;
    border-radius: 20px;
    margin: 2rem 0;
    box-shadow: 0 10px 30px rgba(36, 59, 85, 0.3);
    transition: transform 0.4s ease;
  }
  #wish-page img:hover {
    transform: scale(1.05);
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Responsive */
  @media (max-width: 480px) {
    #puzzle-board {
      width: 280px;
      height: 360px;
    }
    #wish-page img {
      max-width: 220px;
    }
    .start-btn, #shuffleBtn {
      font-size: 1rem;
      padding: 14px 36px;
    }
    nav h2 {
      font-size: 1.3rem;
    }
    nav div a {
      font-size: 1rem;
      margin-left: 1rem;
    }
  }
</style>
</head>
<body>
  <nav>
  <h2>HBD To Manus</h2>
  <div>
    <button type="button" class="nav-btn" onclick="showPopupText('about')">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö</button>
    <button type="button" class="nav-btn" onclick="showPopupText('rules')">‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤</button>
  </div>
</nav>


  <div id="back-btn">
    <button onclick="goBack()">‚¨Ö ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
  </div>

  <div id="intro-page">
    <header>
      <h1>‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏û‡∏£‡∏™‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡∏™ üéÇ</h1>
      <p>
        ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡∏™<br>
       ‡πÄ‡∏•‡∏¢‡∏ó‡∏≥‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏û‡∏£‡∏™‡πå‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡∏™‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö<br>

  
      <button class="start-btn" onclick="startGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÄ‡∏•‡∏¢ üöÄ</button>
    </header>
  </div>

  <div id="game-page">
    <h1>üéÅ ‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡πà‡∏≠‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö</h1>
    <div id="puzzle-board"></div>
    <div class="center-btn">
      <button id="shuffleBtn">üîÑ ‡∏™‡∏•‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</button>
    </div>
  </div>

  <div class="popup" id="successPopup">
    <div class="popup-content">
      <h2>‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö! üéâ</h2>
      <p>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≠‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!</p>
      <button onclick="goToWishPage()">‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£ üéÅ</button>
    </div>
  </div>

  <div class="popup" id="infoPopup">
    <div class="popup-content">
      <h2 id="popup-title"></h2>
      <p id="popup-text"></p>
      <button onclick="closePopup()">‡∏õ‡∏¥‡∏î</button>
    </div>
  </div>

  <div id="wish-page">
    <header>
      <h1>‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏£‡∏±‡∏ö‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡∏™ üéâ</h1>
      <img src="nat4.jpg" alt="‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡∏™" />
      <p>
        ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡∏™‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á ‡∏Ñ‡∏¥‡∏î‡∏´‡∏ß‡∏±‡∏á‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏î‡∏™‡∏°‡∏õ‡∏£‡∏≤‡∏ñ‡∏ô‡∏≤ ‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≤‡∏û‡∏ö‡πÅ‡∏ï‡πà‡∏™‡∏¥‡πà‡∏á‡∏î‡∏µ‡πÜ ‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏Ñ‡∏ô‡∏î‡∏µ‡πÜ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏ï‡πá‡∏°‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï
‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÉ‡∏´‡∏°‡πà‡πÜ ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ‡∏î‡πâ‡∏≤‡∏ô
‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≤‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏†‡∏≤‡∏Ñ‡∏†‡∏π‡∏°‡∏¥‡πÉ‡∏à‡πÉ‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏°‡∏≤‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡πÅ‡∏£‡∏á‡πÉ‡∏à‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï
<br><br>
        ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏û‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏°‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡πÜ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡∏ö üôèüíô
      </p>
    </header>
  </div>

<script>
  const board = document.getElementById('puzzle-board');
  const popup = document.getElementById('successPopup');
  const introPage = document.getElementById('intro-page');
  const gamePage = document.getElementById('game-page');
  const wishPage = document.getElementById('wish-page');
  const backBtn = document.getElementById('back-btn');

  let currentPage = 'intro';

  function startGame() {
    introPage.style.display = 'none';
    gamePage.style.display = 'block';
    backBtn.style.display = 'block';
    currentPage = 'game';
  }

  function goToWishPage() {
    popup.style.display = 'none';
    gamePage.style.display = 'none';
    wishPage.style.display = 'block';
    currentPage = 'wish';
  }

  function goBack() {
    if (currentPage === 'game') {
      gamePage.style.display = 'none';
      introPage.style.display = 'block';
      backBtn.style.display = 'none';
      currentPage = 'intro';
    } else if (currentPage === 'wish') {
      wishPage.style.display = 'none';
      gamePage.style.display = 'block';
      currentPage = 'game';
    }
  }

  function showPopupText(type) {
    const popup = document.getElementById('infoPopup');
    const title = document.getElementById('popup-title');
    const text = document.getElementById('popup-text');

    if (type === 'about') {
      title.textContent = '‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ';
      text.innerHTML = `
        ‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡∏à‡∏∞‡πÄ‡∏≠‡∏≤‡∏°‡∏≤‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏û‡∏£‡∏™‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡∏™‡∏Ñ‡∏£‡∏±‡∏ö üéâ<br><br>
        ‡∏ô‡∏±‡πà‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡∏á‡πà‡∏≤‡∏¢‡πÜ‡πÑ‡∏ß‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡πÄ‡∏•‡πá‡∏Å‡πÜ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏î‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡∏Ñ‡∏£‡∏±‡∏ö<br><br>
        ‡∏ï‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡πá‡πÄ‡∏à‡∏≠‡∏ö‡∏±‡πä‡∏Å‡∏ö‡πâ‡∏≤‡∏á ‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡∏á‡∏á‡πÜ ‡πÇ‡∏Ñ‡πâ‡∏î‡∏û‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏á ‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏™‡∏ô‡∏∏‡∏Å‡πÅ‡∏•‡∏∞‡∏†‡∏π‡∏°‡∏¥‡πÉ‡∏à‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏à‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏î‡πâ üíô
      `;
    } else if (type === 'rules') {
      title.textContent = '‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡πÄ‡∏Å‡∏°';
      text.innerHTML = `
        ‡πÄ‡∏Å‡∏°‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Å‡∏°‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå‡∏á‡πà‡∏≤‡∏¢‡πÜ‡∏Ñ‡∏£‡∏±‡∏ö üéØ<br><br>
        üëâ ‡πÅ‡∏Ñ‡πà‡∏Å‡∏î‡πÅ‡∏ä‡πà‡∏à‡∏¥‡∏Å‡∏ã‡∏≠‡∏ß‡πå‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≤‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏¥‡πâ‡∏ô‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á <br>
        üëâ ‡∏ñ‡πâ‡∏≤‡∏ï‡πà‡∏≠‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏±‡∏ö <br><br>
        ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏ô‡∏∏‡∏Å‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üéà
      `;
    }

    popup.style.display = 'flex';
  }

  function closePopup() {
    document.getElementById('infoPopup').style.display = 'none';
  }

  const cols = 3;
  const rows = 3;
  let pieces = [];
  const image = 'nat3.jpg';

  function createPuzzle() {
    board.innerHTML = '';
    pieces = [];
    for (let i = 0; i < cols * rows; i++) {
      const piece = document.createElement('div');
      piece.classList.add('piece');
      piece.dataset.correctIndex = i;
      const row = Math.floor(i / cols);
      const col = i % cols;
      piece.style.backgroundImage = `url('${image}')`;
      piece.style.backgroundPosition = `${(col * 100) / (cols - 1)}% ${(row * 100) / (rows - 1)}%`;
      piece.style.backgroundSize = `${cols * 100}% ${rows * 100}%`;
      piece.draggable = true;
      piece.addEventListener('dragstart', dragStart);
      piece.addEventListener('dragover', dragOver);
      piece.addEventListener('drop', drop);
      piece.addEventListener('dragend', dragEnd);
      pieces.push(piece);
      board.appendChild(piece);
    }
  }

  let dragSrcIndex = null;

  function dragStart(e) {
    dragSrcIndex = pieces.indexOf(this);
    e.dataTransfer.setData('text/html', this.outerHTML);
    this.style.opacity = '0.5';
  }
  function dragOver(e) { e.preventDefault(); }
  function drop(e) {
    e.stopPropagation();
    const dragTargetIndex = pieces.indexOf(this);
    if (dragSrcIndex === dragTargetIndex) return;
    swapPieces(dragSrcIndex, dragTargetIndex);
    if (checkWin()) setTimeout(showPopup, 300);
  }
  function dragEnd() { this.style.opacity = '1'; }
  function swapPieces(i, j) {
    [pieces[i], pieces[j]] = [pieces[j], pieces[i]];
    pieces.forEach(p => board.appendChild(p));
  }
  function shufflePuzzle() {
    for (let i = pieces.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      swapPieces(i, j);
    }
  }
  function checkWin() {
    return pieces.every((p, i) => Number(p.dataset.correctIndex) === i);
  }
  function showPopup() {
    popup.style.display = 'flex';
  }

  document.getElementById('shuffleBtn').addEventListener('click', shufflePuzzle);

  createPuzzle();
  shufflePuzzle();
</script>
</body>
</html>
